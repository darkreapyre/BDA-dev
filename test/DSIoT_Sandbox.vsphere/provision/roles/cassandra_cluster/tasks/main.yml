---
- name: Stop Cassandra
  service: name=cassandra enabled=yes state=stopped

- name: Clean default configuration
  shell: sudo rm -rf /var/lib/cassandra/data/system*

#Option 1: netaddr package
#broadcast_rpc_address: {{ ipv4_host | ipaddr('address') }}
#Option 2: eth0 <-- Preferred
#broadcast_rpc_address: {{ ansible_eth0.ipv4.address }}
#Option 2: default ip addredd <-- current
#broadcast_rpc_address: {{ ansible_default_ipv4.address }}
- name: Copy the configuraiton template
  template: src=cassandra.yaml.j2 dest=/etc/cassandra/cassandra.yaml

- name: Start the Cassandra Cluster
  service: name=cassandra enabled=yes state=started

# On the first node of the cluster, run:
#sudo nodetool -status
---
- name: Create notebooks directory
  file:
    state: directory
    dest: /home/{{ cluster_user }}/notebooks
    owner: "{{ cluster_user }}"
    group: "{{ cluster_user }}"

- name: Install Jupyter for Python3
  pip: name=jupyter executable=pip3

- name: Install Jupyter for Python2
  pip: name=jupyter

- name: Install Python2 kernel
  command: python2 -m ipykernel install

- name: Generate notebook config
  command: jupyter notebook --generate-config
#  become: yes
#  become_user: "{{ cluster_user }}"
#  become_method: su

- name: Create Jupyter default config
  template:
    src=jupyter_notebook_config.py.j2
    dest=/home/{{ cluster_user }}/.jupyter/jupyter_notebook_config.py
    owner={{ cluster_user }}
    group={{ cluster_user }}
#  become: yes
#  become_user: "{{ cluster_user }}"
#  become_method: su

- name: Disable notebook warnings
  template: src=disable-warning.py.j2 dest=/home/{{ cluster_user }}/.ipython/profile_default/startup/disable-warning.py

# The following is still TODO
#- name: Configure upstart script
#  template:
#    src: upstart.conf.j2
#    dest: /etc/init/ipython-notebook.conf
#  notify: restart ipython-notebook
#
#- include: nbextensions.yml
#
#- name: Start Jupyter
#  service: name=ipython-notebook state=started
